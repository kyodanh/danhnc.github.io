<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Firebase</title>
</head>
<body>
    <h1>Firebase Connection Test</h1>
    <div id="result"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="js/firebase-config.js"></script>

    <script>
        const resultDiv = document.getElementById('result');

        setTimeout(async () => {
            try {
                resultDiv.innerHTML = '<p>Checking Firebase...</p>';

                if (typeof window.firebaseDB === 'undefined') {
                    resultDiv.innerHTML = '<p style="color: red;">Firebase not loaded!</p>';
                    return;
                }

                resultDiv.innerHTML = '<p style="color: green;">Firebase loaded! Fetching posts...</p>';

                const snapshot = await window.firebaseDB.collection('posts')
                    .orderBy('createdAt', 'desc')
                    .get();

                resultDiv.innerHTML = `<p style="color: green;">Found ${snapshot.size} posts</p>`;

                snapshot.forEach(doc => {
                    const data = doc.data();
                    resultDiv.innerHTML += `
                        <div style="border: 1px solid #ccc; padding: 10px; margin: 10px 0;">
                            <h3>${data.title}</h3>
                            <p>Category: ${data.category}</p>
                            <p>Excerpt: ${data.excerpt}</p>
                            <p>Created: ${data.createdAt ? data.createdAt.toDate().toString() : 'N/A'}</p>
                        </div>
                    `;
                });

            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                console.error('Error:', error);
            }
        }, 1000);
    </script>
</body>
</html>
